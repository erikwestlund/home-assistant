- name: "Office Heat Pump Operational Mode"
  unique_id: office_heatpump_operational_mode
  state: >-
    {% set outdoor_temp = states('sensor.current_nws_outdoor_temperature') | float %}
    {% set off_threshold = states('input_number.office_heatpump_off_to_supplement_threshold') | float %}
    {% set comfort_threshold = states('input_number.office_heatpump_supplement_to_comfort_threshold') | float %}
    {% if outdoor_temp < off_threshold %}
      Off
    {% elif outdoor_temp <= comfort_threshold %}
      Supplement
    {% else %}
      Comfort
    {% endif %}
  icon: >-
    {% set mode = states('sensor.office_heat_pump_operational_mode') %}
    {% if mode == 'Off' %}
      mdi:power-off
    {% elif mode == 'Supplement' %}
      mdi:leaf
    {% else %}
      mdi:thermometer
    {% endif %}