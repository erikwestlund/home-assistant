# ðŸŸ¢ HVAC Preheat Required Master Bedroom
- name: "HVAC Preheat Required Master Bedroom"
  unique_id: hvac_preheat_required_master_bedroom
  state: >
    {% set preheating_window = is_state('binary_sensor.hvac_preheating_window_master_bedroom', 'on') %}
    {% set estimated_target_time = as_timestamp(states('sensor.hvac_estimated_time_when_target_temperature_reached_starting_now_master_bedroom')) %}
    {% set preheat_end = as_timestamp(now().date() ~ ' ' ~ states('input_datetime.hvac_preheat_end_window_master_bedroom')) %}
    
    {{ preheating_window and estimated_target_time > preheat_end }}
  device_class: heat
  icon: mdi:clock-alert

# ðŸ”¥ HVAC Preheat Active Master Bedroom
- name: "HVAC Preheat Active Master Bedroom"
  unique_id: hvac_preheat_active_master_bedroom
  state: >
    {% set preheating_on = is_state('input_boolean.hvac_preheating_on_master_bedroom', 'on') %}
    {% set stop_override = is_state('input_boolean.hvac_preheating_stop_override_master_bedroom', 'on') %}
    {% set daytime_avg_temp = states('input_number.hvac_avg_temp_daytime_master_bedroom') | float %}
    {% set off_threshold = states('input_number.hvac_mini_split_preheating_off_threshold_master_bedroom') | float %}

    {{ preheating_on and not stop_override and daytime_avg_temp > off_threshold }}
  device_class: heat
  icon: mdi:fire